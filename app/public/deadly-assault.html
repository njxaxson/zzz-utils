<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ZZZ Deadly Assault Team Builder</title>
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <link rel="stylesheet" href="style.css">
    <!-- Pako compression library for roster sharing -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pako/2.1.0/pako.min.js"></script>
</head>
<body>
    <div class="container extra-wide">
        <div id="header-container"></div>

        <main>
            <!-- Boss Selection Section -->
            <section class="boss-selection-section">
                <h3>Select 3 Bosses</h3>
                <p class="section-description">Choose the three Deadly Assault bosses you want to build teams for.</p>
                <div class="boss-grid" id="boss-grid"></div>
            </section>

            <!-- Shared Roster Banner (shown when viewing shared roster) -->
            <div class="shared-roster-banner" id="shared-roster-banner" style="display: none;">
                <span class="shared-icon">ðŸ”—</span>
                <span class="shared-text">Viewing a shared roster. Changes will not be saved.</span>
                <a href="deadly-assault.html" class="shared-reset-link">Use your own roster</a>
            </div>

            <!-- Unit Selection Section - Collapsible -->
            <details class="roster-section" id="roster-section" open>
                <summary class="roster-header">
                    <h3>Your Roster</h3>
                    <button type="button" class="share-btn" id="share-roster-btn" title="Share this roster">
                        <svg class="share-icon" viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <circle cx="18" cy="5" r="3"></circle>
                            <circle cx="6" cy="12" r="3"></circle>
                            <circle cx="18" cy="19" r="3"></circle>
                            <line x1="8.59" y1="13.51" x2="15.42" y2="17.49"></line>
                            <line x1="15.41" y1="6.51" x2="8.59" y2="10.49"></line>
                        </svg>
                        <span class="share-text">Share</span>
                    </button>
                    <span class="roster-toggle-hint">Click to toggle ownership. <span class="highlight-universal">Right-click</span> to mark as <strong style="color: var(--text-primary)">FLEX</strong> â€” can complete any team, even without activating their additional ability.</span>
                </summary>
                
                <div class="roster-content">
                    <!-- Limited S-Rank Subsection -->
                    <div class="roster-subsection" id="limited-s-section">
                        <div class="subsection-header">
                            <span class="subsection-title">Limited S-Rank</span>
                            <span class="subsection-count" id="limited-s-count">0/0</span>
                            <div class="subsection-actions">
                                <button type="button" class="subtle-btn select-all" data-category="limited-s">All</button>
                                <button type="button" class="subtle-btn deselect-all" data-category="limited-s">None</button>
                            </div>
                        </div>
                        <div class="unit-grid" id="limited-s-grid"></div>
                    </div>

                    <!-- Standard S-Rank Subsection -->
                    <div class="roster-subsection" id="standard-s-section">
                        <div class="subsection-header">
                            <span class="subsection-title">Standard S-Rank</span>
                            <span class="subsection-count" id="standard-s-count">0/0</span>
                            <div class="subsection-actions">
                                <button type="button" class="subtle-btn select-all" data-category="standard-s">All</button>
                                <button type="button" class="subtle-btn deselect-all" data-category="standard-s">None</button>
                            </div>
                        </div>
                        <div class="unit-grid" id="standard-s-grid"></div>
                    </div>

                    <!-- A-Rank Subsection -->
                    <div class="roster-subsection" id="a-rank-section">
                        <div class="subsection-header">
                            <span class="subsection-title">A-Rank</span>
                            <span class="subsection-count" id="a-rank-count">0/0</span>
                            <div class="subsection-actions">
                                <button type="button" class="subtle-btn select-all" data-category="a-rank">All</button>
                                <button type="button" class="subtle-btn deselect-all" data-category="a-rank">None</button>
                            </div>
                        </div>
                        <div class="unit-grid" id="a-rank-grid"></div>
                    </div>
                </div>
            </details>

            <!-- Validation & Run -->
            <section class="action-section">
                <div id="validation-errors" class="validation-errors" style="display: none;"></div>
                <button id="run-btn" class="run-btn">Find Optimal Teams</button>
            </section>

            <!-- Results Section -->
            <section class="results-section" id="results-section" style="display: none;">
                <h3>Recommended Team Allocations</h3>
                <div id="results-container"></div>
            </section>
        </main>

        <div id="footer-container"></div>
    </div>

    <script type="module">
        import { loadSharedComponents } from './lib/components.js';
        loadSharedComponents('deadly-assault');
    </script>
    <script type="module" src="deadly-assault.js"></script>
</body>
</html>
